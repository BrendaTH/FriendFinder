<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Friend Finder</title>
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>
</head>

<body>

    <div class="container">
        <div class="row">
            <div class="col-12">
                <div class="card mb-4">
                    <div class="card-header">
                        <h3><strong>Survey Questions (where 1 is strongly agree and 5 is strongly disagree)</strong></h3>
                    </div>

                    <div class="card-body">
                        <form>
                            <div class="form-group">

                                <label for="name">Name (Required)</label>
                                <input type="text" class="form-control" id="name">
                            </div>

                            <div class="form-group">
                                <label for="image">Link to Photo Image (Required)</label>
                                <input type="text" class="form-control" id="image">
                            </div>
                            <!-- Survey Begins -->
                            <h3><strong> Question 0:</strong></h3>
                            <h4>Your mind is always buzzing with unexplored ideas and plans.</h4>
                            <div class="dropdown">
                                <button class="btn btn-secondary dropdown-toggle" type="button" id="dropdownq0" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                Dropdown button0
                                </button>
                                <div class="dropdown-menu" id='q0' aria-labelledby="dropdownMenuButton">
                                    <a class="dropdown-item" href="#">1</a>
                                    <a class="dropdown-item" href="#">2</a>
                                    <a class="dropdown-item" href="#">3</a>
                                    <a class="dropdown-item" href="#">4</a>
                                    <a class="dropdown-item" href="#">5</a>
                                </div>
                            </div>
                            <br>

                            <h3><strong> Question 1:</strong></h3>
                            <h4>Generally speaking, you rely more on your experience than your imagination.</h4>
                            <div class="dropdown show">
                                <a class="btn btn-secondary dropdown-toggle" href="#" role="button" id="dropdownq1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                    Dropdown link1
                                </a>
                                <div class="dropdown-menu" id='q1' aria-labelledby="dropdownMenuLink">
                                    <a class="dropdown-item" href="#">1</a>
                                    <a class="dropdown-item" href="#">2</a>
                                    <a class="dropdown-item" href="#">3</a>
                                    <a class="dropdown-item" href="#">4</a>
                                    <a class="dropdown-item" href="#">5</a>
                                </div>
                            </div>
                            <br>

                            <h3><strong> Question 2:</strong></h3>
                            <h4>You find it easy to stay relaxed and focused even when there is some pressure.</h4>
                            <div class="dropdown show">
                                <a class="btn btn-secondary dropdown-toggle" href="#" role="button" id="dropdownq2" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                    Dropdown link2
                                </a>
                                <div class="dropdown-menu" id='q2' aria-labelledby="dropdownMenuLink">
                                    <a class="dropdown-item" href="#">1</a>
                                    <a class="dropdown-item" href="#">2</a>
                                    <a class="dropdown-item" href="#">3</a>
                                    <a class="dropdown-item" href="#">4</a>
                                    <a class="dropdown-item" href="#">5</a>
                                </div>
                            </div>
                            <br>

                            <h3><strong> Question 3:</strong></h3>
                            <h4>You rarely do something just out of sheer curiosity.</h4>
                            <div class="dropdown show">
                                <a class="btn btn-secondary dropdown-toggle" href="#" role="button" id="dropdownq3" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                    Dropdown link3
                                </a>
                                <div class="dropdown-menu" id='q3' aria-labelledby="dropdownMenuLink">
                                    <a class="dropdown-item" href="#">1</a>
                                    <a class="dropdown-item" href="#">2</a>
                                    <a class="dropdown-item" href="#">3</a>
                                    <a class="dropdown-item" href="#">4</a>
                                    <a class="dropdown-item" href="#">5</a>
                                </div>
                            </div>
                            <br>

                            <h3><strong> Question 4:</strong></h3>
                            <h4>People can rarely upset you.</h4>
                            <div class="dropdown show">
                                <a class="btn btn-secondary dropdown-toggle" href="#" role="button" id="dropdownq4" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                    Dropdown link4
                                </a>
                                <div class="dropdown-menu" id='q4' aria-labelledby="dropdownMenuLink">
                                    <a class="dropdown-item" href="#">1</a>
                                    <a class="dropdown-item" href="#">2</a>
                                    <a class="dropdown-item" href="#">3</a>
                                    <a class="dropdown-item" href="#">4</a>
                                    <a class="dropdown-item" href="#">5</a>
                                </div>
                            </div>
                            <br>

                            <h3><strong> Question 5:</strong></h3>
                            <h4>It is often difficult for you to relate to other people’s feelings.</h4>
                            <div class="dropdown show">
                                <a class="btn btn-secondary dropdown-toggle" href="#" role="button" id="dropdownq5" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                    Dropdown link5
                                </a>
                                <div class="dropdown-menu" id='q5' aria-labelledby="dropdownMenuLink">
                                    <a class="dropdown-item" href="#">1</a>
                                    <a class="dropdown-item" href="#">2</a>
                                    <a class="dropdown-item" href="#">3</a>
                                    <a class="dropdown-item" href="#">4</a>
                                    <a class="dropdown-item" href="#">5</a>
                                </div>
                            </div>
                            <br>

                            <h3><strong> Question 6:</strong></h3>
                            <h4>In a discussion, truth should be more important than people’s sensitivities.</h4>
                            <div class="dropdown show">
                                <a class="btn btn-secondary dropdown-toggle" href="#" role="button" id="dropdownq6" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                    Dropdown link6
                                </a>
                                <div class="dropdown-menu" id='q6' aria-labelledby="dropdownMenuLink">
                                    <a class="dropdown-item" href="#">1</a>
                                    <a class="dropdown-item" href="#">2</a>
                                    <a class="dropdown-item" href="#">3</a>
                                    <a class="dropdown-item" href="#">4</a>
                                    <a class="dropdown-item" href="#">5</a>
                                </div>
                            </div>
                            <br>

                            <h3><strong> Question 7:</strong></h3>
                            <h4>You rarely get carried away by fantasies and ideas.</h4>
                            <div class="dropdown show">
                                <a class="btn btn-secondary dropdown-toggle" href="#" role="button" id="dropdownq7" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                    Dropdown link7
                                </a>
                                <div class="dropdown-menu" id='q7' aria-labelledby="dropdownMenuLink">
                                    <a class="dropdown-item" href="#">1</a>
                                    <a class="dropdown-item" href="#">2</a>
                                    <a class="dropdown-item" href="#">3</a>
                                    <a class="dropdown-item" href="#">4</a>
                                    <a class="dropdown-item" href="#">5</a>
                                </div>
                            </div>
                            <br>

                            <h3><strong> Question 8:</strong></h3>
                            <h4>You think that everyone’s views should be respected regardless of whether they are supported by facts or not.</h4>
                            <div class="dropdown show">
                                <a class="btn btn-secondary dropdown-toggle" href="#" role="button" id="dropdownq8" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                    Dropdown link8
                                </a>
                                <div class="dropdown-menu" id='q8' aria-labelledby="dropdownMenuLink">
                                    <a class="dropdown-item" href="#">1</a>
                                    <a class="dropdown-item" href="#">2</a>
                                    <a class="dropdown-item" href="#">3</a>
                                    <a class="dropdown-item" href="#">4</a>
                                    <a class="dropdown-item" href="#">5</a>
                                </div>
                            </div>
                            <br>

                            <h3><strong> Question 9:</strong></h3>
                            <h4>You feel more energetic after spending time with a group of people.</h4>
                            <div class="dropdown show">
                                <a class="btn btn-secondary dropdown-toggle" href="#" role="button" id="dropdownq9" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                                    Dropdown link9
                                </a>
                                <div class="dropdown-menu" id='q9' aria-labelledby="dropdownMenuLink">
                                    <a class="dropdown-item" href="#">1</a>
                                    <a class="dropdown-item" href="#">2</a>
                                    <a class="dropdown-item" href="#">3</a>
                                    <a class="dropdown-item" href="#">4</a>
                                    <a class="dropdown-item" href="#">5</a>
                                </div>
                            </div>
                            <br>
                            <div class="text-right">
                                <button class="btn btn-primary btn-md" id="add-btn" type="submit">Submit</button>
                            </div>
                        </form>
                    </div> <!-- close card body -->
                </div> <!-- card-->
            </div> <!-- col-->
        </div> <!-- row -->
    </div> <!-- container-->

    <!-- Put modal here -->
    <div class="modal fade" id="my-friends-modal">
            <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content">

                    <!-- Modal Header -->
                    <div class="modal-header">
                        <h4 class="modal-title">
                            <strong>We found a new friend for you....</strong>
                        </h4>
                        <button type="button" class="close" data-dismiss="modal">&times;</button>
                    </div>

                    <!-- Modal body -->
                    <div class="modal-body ">
                        <h4 id="my-friends-name"></h4>
                        <div class="text-center">
                            <img class="img-fluid" id="my-friends-photo" src="#">
                        </div>
                    </div>

                    <!-- Modal footer -->
                    <div class="modal-footer">
                        <button type="button" class="btn btn-danger" data-dismiss="modal">Close</button>
                    </div>

                </div>
            </div>
        </div>

<!-- begin processing javascript below -->
<script type="text/javascript">
    // validate the fields in the survey
    function isValid() {
        if ($('#name').val().trim()
            && $('#image').val().trim()
            && parseInt($('#dropdownq0').text())
            && parseInt($('#dropdownq1').text())
            && parseInt($('#dropdownq2').text())
            && parseInt($('#dropdownq3').text())
            && parseInt($('#dropdownq4').text())
            && parseInt($('#dropdownq5').text())
            && parseInt($('#dropdownq6').text())
            && parseInt($('#dropdownq7').text())
            && parseInt($('#dropdownq8').text())
            && parseInt($('#dropdownq9').text())) {
            return true;
        } else {
            return false;
        }
    }

    // update the html survey button with users selection
    $(function(){
        $(".dropdown-menu a").click(function(event){
            event.preventDefault();
            var id = $(this).parent().attr('id');
            console.log('id is: ' + id);
            $('#dropdown' + id).text($(this).text());
            $('#dropdown' + id).val($(this).text());
        });
    });


    // send new friend to the server
    // get back a best friend
    $("#add-btn").on("click", function(event) {
        event.preventDefault();
        // make sure all data is filled out
        // else you could crash the server
        if (!isValid()) {
            alert('please populate all fields');
        } else {
            // all fields populated
            var friendItemObj = {
                name: $('#name').val().trim(),
                photo: $('#image').val().trim(),
                scores: [
                    $('#dropdownq0').text(),
                    $('#dropdownq1').text(),
                    $('#dropdownq2').text(),
                    $('#dropdownq3').text(),
                    $('#dropdownq4').text(),
                    $('#dropdownq5').text(),
                    $('#dropdownq6').text(),
                    $('#dropdownq7').text(),
                    $('#dropdownq8').text(),
                    $('#dropdownq9').text()],
            };

            $.post("/api/friends", friendItemObj)
            .then(function(data) {
                $("#my-friends-name").text(data.name);
                $("#my-friends-photo").attr("src", data.photo);
                $("#my-friends-modal").modal('toggle');
            });
        }
    });

  </script>
</body>

</html>
